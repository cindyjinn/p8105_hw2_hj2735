---
title: "p8105_hw2_hj2735"
author: "cindyjin"
date: "2025-09-30"
output: html_document
---

### Problem 1 

```{r Problem 1}
library(tidyverse)

# Load CSV from the data/ subdirectory
pols_month = read_csv("data/fivethirtyeight_datasets/pols-month.csv")
unemployment = read_csv("data/fivethirtyeight_datasets/unemployment.csv")
snp = read_csv("data/fivethirtyeight_datasets/snp.csv")
```

```{r}
pols_month = pols_month |>
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) |>
  mutate(
    month     = factor(month.name[month], levels = month.name),   # replace number with month name
    president = if_else(prez_gop == 1, "gop", "dem")              # create president variable
  ) |>
  select(year, month, everything(), -prez_dem, -prez_gop, -day) |>  # remove prez_dem, prez_gop, day
  arrange(year, month)

# Preview cleaned data
glimpse(pols_month)
head(pols_month)
```

```{r}
# Clean snp data
snp = snp |>
  separate(date, into = c("month", "day", "year"), sep = "/", convert = TRUE) |>
  mutate(
    # Convert 2-digit year to 4-digit year
    year = if_else(year < 50, year + 2000, year + 1900),
    month = factor(month.name[month], levels = month.name)
  ) |>
  select(year, month, everything(), -day) |>
  arrange(year, month)

# Preview cleaned data
glimpse(snp)
head(snp)

```


```{r}
unemployment = unemployment |>
  pivot_longer(
    cols = -Year,
    names_to = "month",
    values_to = "unemployment"
  ) |>
  mutate(
    year  = Year,
    # standardize month abbreviations to full names
    month = recode(month,
                   Jan = "January", Feb = "February", Mar = "March",
                   Apr = "April",   May = "May",      Jun = "June",
                   Jul = "July",    Aug = "August",   Sep = "September",
                   Oct = "October", Nov = "November", Dec = "December"),
    month = factor(month, levels = month.name),
    unemployment = as.numeric(unemployment)
  ) |>
  select(year, month, unemployment) |>
  arrange(year, month)

# Preview cleaned unemployment data
glimpse(unemployment)
head(unemployment)
```

```{r}
merged = pols_month |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemployment, by = c("year", "month"))

# Quick summary
dim(merged)
range(merged$year)
names(merged)

```

The **`pols_month`** dataset provides monthly data, including the number of national politicians by party affiliation and an indicator of the president’s party (Democrat or Republican). The **`snp`** dataset records closing values of the S&P stock index on a monthly basis, giving a financial measure of U.S. market performance. The **`unemployment`** dataset contains monthly unemployment rates across the U.S. economy.  

After cleaning and merging these three sources, the resulting dataset contains information on **politics, markets, and the economy** in one place. The merged data frame has `r dim(merged)[1]` rows and `r dim(merged)[2]` columns, covering the years from `r min(merged$year)` through `r max(merged$year)`. Key variables include `year`, `month`, `president`, `close` (S&P closing price), and `unemployment`. This unified dataset allows for examining relationships between political events, stock market fluctuations, and unemployment trends across decades.  


```{r}
# save the merged result for reference
write_csv(merged, "data/merged_pols_snp_unemployment.csv")
```

### Problem 2

```{r}
library(readxl)
library(janitor)
trash_path = "data/202509 Trash Wheel Collection Data.xlsx" 
```

```{r}
read_trash <- function(sheet_name, wheel_label) {
  read_excel(trash_path, sheet = sheet_name, skip = 1) |>
    clean_names() |>
    # keep only dumpster-specific rows (omit notes / figures)
    filter(!is.na(dumpster)) |>
    # standardize types and add identifier
    mutate(
      month = as.character(month),
      year  = as.integer(year),
      trash_wheel = wheel_label
    ) |>
    # round sports_balls to int if the column exists on that sheet
    mutate(across(any_of("sports_balls"), ~ as.integer(round(.x)))) |>
    # drop any columns that are entirely NA (leftover “notes” columns after clean_names)
    select(where(~ !all(is.na(.x))))
}

mr   <- read_trash("Mr. Trash Wheel", "Mr. Trash Wheel")
prof <- read_trash("Professor Trash Wheel", "Professor Trash Wheel")
gwyn <- read_trash("Gwynns Falls Trash Wheel", "Gwynnda")

# combine all three into one tidy dataset
trash_all <- bind_rows(mr, prof, gwyn)

```

```{r}
n_obs   <- nrow(trash_all)
n_vars  <- ncol(trash_all)
year_lo <- min(trash_all$year, na.rm = TRUE)
year_hi <- max(trash_all$year, na.rm = TRUE)

# summaries
prof_total_weight <- prof |>
  summarise(total_weight_tons = sum(weight_tons, na.rm = TRUE)) |>
  pull(total_weight_tons)

gwyn_june22_cigs <- gwyn |>
  filter(year == 2022, month == "June") |>
  summarise(total_cigs = sum(cigarette_butts, na.rm = TRUE)) |>
  pull(total_cigs)

```

The **`Mr. Trash Wheel`** dataset provides per-dumpster collection records (by month and year), including weight and volume of trash removed and counts of common debris (e.g., plastic bottles, polystyrene, cigarette butts). The **`Professor Trash Wheel`** dataset contains the same types of measures for a different installation, recorded with the same structure. The **`Gwynnda (Gwynns Falls Trash Wheel)`** dataset likewise reports per-dumpster totals for weight, volume, and itemized debris counts.  

After cleaning and combining these three sources, the resulting dataset contains information on **trash removal activity across multiple Trash Wheels** in one place. The merged data frame has **`r dim(trash_all)[1]`** rows and **`r dim(trash_all)[2]`** columns, covering the years from **`r min(trash_all$year, na.rm = TRUE)`** through **`r max(trash_all$year, na.rm = TRUE)`**. Key variables include `trash_wheel` (source identifier), `dumpster`, `month`, `year`, `date`, `weight_tons`, `volume_cubic_yards`, `plastic_bottles`, `polystyrene`, `cigarette_butts`, `glass_bottles`, `plastic_bags`, `wrappers`, `sports_balls` (where available), and `homes_powered`. 


```{r}
# save merged
write_csv(trash_all, "data/merged_trash_wheels.csv")
```


### Problem 3

```{r}

```

```{r}

```

```{r}


```




